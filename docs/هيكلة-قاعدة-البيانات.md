# هيكلة قاعدة البيانات لتطبيق "صحتك بالدنيا"

## مقدمة

يقدم هذا المستند تصميماً شاملاً لهيكل قاعدة بيانات تطبيق "صحتك بالدنيا"، باستخدام Firebase Firestore كنظام قاعدة بيانات NoSQL. الهدف هو تحسين هيكل البيانات الحالي وتوحيد تسميات الحقول وإنشاء الفهارس المناسبة، مما يؤدي إلى تحسين أداء الاستعلامات وتسهيل الصيانة والتوسع المستقبلي.

## مبادئ التصميم

عند تصميم هيكل قاعدة البيانات الجديد، تم الالتزام بالمبادئ التالية:

1. **تقليل التكرار**: تجنب تكرار نفس البيانات في أماكن متعددة
2. **توحيد التسميات**: استخدام اصطلاح تسمية موحد (camelCase) لكافة الحقول
3. **التجزئة المنطقية**: تقسيم البيانات إلى مجموعات منطقية حسب الوظيفة
4. **تحسين الأداء**: تصميم هيكل يدعم أنماط الاستعلام الشائعة
5. **المرونة**: السماح بتوسع البيانات في المستقبل دون تغييرات هيكلية كبيرة
6. **توافق التطبيقات**: دعم الاستخدام عبر تطبيقات الويب والجوال

## هيكل المجموعات (Collections)

### 1. مجموعة المستخدمين `users`

تخزن البيانات الأساسية للمستخدمين وإعدادات الحساب.

```javascript
// وثيقة المستخدم - المعرّف: uid من Firebase Authentication
{
  // المعلومات الأساسية
  displayName: "كامل المنجليفي",
  email: "user@example.com",
  phoneNumber: "+9665XXXXXXXX",
  photoURL: "https://example.com/photo.jpg",
  createdAt: Timestamp,
  lastLogin: Timestamp,
  
  // الإعدادات
  settings: {
    language: "ar",
    notifications: true,
    theme: "light",
    privacyLevel: "private"
  },
  
  // حالة المستخدم
  status: "active", // active, inactive, suspended
  role: "user",     // user, nutritionist, admin
  
  // معلومات إضافية
  gender: "male",
  birthDate: Timestamp,
  height: 178,
  currentWeight: 75,
  
  // العلاقة مع أخصائيين
  linkedNutritionists: ["nutritionistId1", "nutritionistId2"]
}
```

### 2. مجموعة الملفات الطبية `medicalProfiles`

تخزن المعلومات الطبية التفصيلية للمستخدمين.

```javascript
// وثيقة الملف الطبي - المعرّف: نفس uid المستخدم
{
  // المعلومات الأساسية
  userId: "userId",
  lastUpdated: Timestamp,
  
  // المعلومات الصحية الأساسية
  basicInfo: {
    bloodType: "A+",
    weight: 75,
    height: 178,
    bmi: 23.7,
    waistCircumference: 85,
    allergies: ["لاكتوز", "فول سوداني"],
    chronicConditions: ["سكري النوع 2", "ضغط دم مرتفع"]
  },
  
  // التاريخ العائلي
  familyHistory: {
    conditions: [
      {
        condition: "سكري",
        relation: "أب"
      },
      {
        condition: "ضغط دم مرتفع",
        relation: "أم"
      }
    ]
  },
  
  // نمط الحياة
  lifestyle: {
    smokingStatus: "former", // never, former, current
    smokingYears: 5,
    exerciseFrequency: 3, // أيام في الأسبوع
    exerciseIntensity: "moderate", // light, moderate, intense
    sleepHours: 7,
    dietType: "متوسطي" // نباتي، كيتو، متوسطي، إلخ
  }
}
```

### 3. مجموعة القياسات `measurements`

تخزن جميع قياسات المستخدم مثل الوزن، ضغط الدم، مستوى السكر، إلخ.

```javascript
// وثيقة القياس - معرّف تلقائي
{
  userId: "userId",
  type: "weight", // weight, bloodPressure, glucose, cholesterol, etc.
  value: 75, // القيمة الرقمية أو النصية حسب نوع القياس
  unit: "kg", // الوحدة المناسبة لنوع القياس
  timestamp: Timestamp,
  date: "2025-09-10", // للبحث والفرز بسهولة (YYYY-MM-DD)
  notes: "بعد التمرين",
  takenAt: "morning", // morning, afternoon, evening, night
  
  // حقول إضافية حسب نوع القياس
  additionalInfo: {
    // مثال لضغط الدم
    systolic: 120,
    diastolic: 80,
    
    // مثال للسكر
    measurementType: "fasting" // fasting, postMeal, random
  }
}
```

### 4. مجموعة الأدوية `medications`

تخزن معلومات الأدوية التي يتناولها المستخدم.

```javascript
// وثيقة الدواء - معرّف تلقائي
{
  userId: "userId",
  name: "ميتفورمين",
  dosage: "500 مج",
  frequency: "مرتين يومياً",
  timeOfDay: ["morning", "evening"],
  startDate: Timestamp,
  endDate: Timestamp, // يمكن أن تكون null للأدوية المستمرة
  active: true,
  refillReminder: true,
  refillDate: Timestamp,
  prescribedBy: "د. محمد أحمد",
  purpose: "لعلاج السكري",
  notes: "يؤخذ مع الطعام",
  sideEffects: ["غثيان", "إسهال"]
}
```

### 5. مجموعة التذكيرات `reminders`

تخزن تذكيرات المستخدم للأدوية، القياسات، المواعيد، إلخ.

```javascript
// وثيقة التذكير - معرّف تلقائي
{
  userId: "userId",
  title: "أخذ جرعة ميتفورمين",
  description: "500 مج مع وجبة الإفطار",
  type: "medication", // medication, measurement, appointment, water, etc.
  date: "2025-09-13", // للبحث والفرز (YYYY-MM-DD)
  time: "08:00",
  recurrence: "daily", // once, daily, weekly, monthly
  recurrenceDays: [1, 2, 3, 4, 5, 6, 7], // للتكرار الأسبوعي (1=الأحد)
  relatedItemId: "medicationId1", // مرجع للدواء أو الموعد
  isDone: false,
  notificationTime: 15, // دقائق قبل الموعد
  notificationSent: false
}
```

### 6. مجموعة التحاليل الطبية `medicalTests`

تخزن نتائج التحاليل الطبية للمستخدم.

```javascript
// وثيقة التحليل - معرّف تلقائي
{
  userId: "userId",
  date: "2025-09-01",
  timestamp: Timestamp,
  labName: "مختبر المدينة الطبي",
  
  // نتائج التحاليل
  results: [
    {
      testName: "سكر صائم",
      value: 100,
      unit: "mg/dL",
      normalRange: {
        min: 70,
        max: 100
      },
      status: "normal", // normal, low, high, critical
      notes: ""
    },
    {
      testName: "HbA1c",
      value: 5.7,
      unit: "%",
      normalRange: {
        min: 4.0,
        max: 5.6
      },
      status: "high",
      notes: "مرتفع قليلاً"
    }
  ],
  
  // معلومات إضافية
  doctorName: "د. خالد العمري",
  referenceNumber: "LT-2025-12345",
  attachmentURL: "https://storage.example.com/reports/12345.pdf",
  notes: "تحاليل روتينية سنوية"
}
```

### 7. مجموعة الوجبات والتغذية `nutrition`

تخزن سجلات الوجبات والمعلومات الغذائية.

```javascript
// وثيقة الوجبة - معرّف تلقائي
{
  userId: "userId",
  date: "2025-09-13",
  timestamp: Timestamp,
  mealType: "breakfast", // breakfast, lunch, dinner, snack
  
  // مكونات الوجبة
  items: [
    {
      name: "خبز أسمر",
      quantity: 2,
      unit: "شريحة",
      calories: 138,
      carbs: 28,
      protein: 4,
      fat: 2
    },
    {
      name: "بيض مسلوق",
      quantity: 2,
      unit: "حبة",
      calories: 156,
      carbs: 1,
      protein: 12,
      fat: 10
    }
  ],
  
  // إجماليات
  totalCalories: 294,
  totalCarbs: 29,
  totalProtein: 16,
  totalFat: 12,
  
  notes: "وجبة صحية متوازنة",
  photo: "https://storage.example.com/meals/12345.jpg",
  
  // معلومات إضافية
  hungerLevel: 3, // 1-5
  moodAfter: "energetic", // energetic, satisfied, tired, bloated
  location: "المنزل" // المنزل، العمل، مطعم
}
```

### 8. مجموعة النشاط البدني `activities`

تخزن سجلات نشاط المستخدم البدني.

```javascript
// وثيقة النشاط - معرّف تلقائي
{
  userId: "userId",
  date: "2025-09-13",
  timestamp: Timestamp,
  activityType: "walking", // walking, running, swimming, cycling, etc.
  duration: 45, // بالدقائق
  intensity: "moderate", // light, moderate, intense
  caloriesBurned: 320,
  distance: 3.5, // بالكيلومتر
  steps: 4500, // للمشي والجري
  heartRate: {
    average: 125,
    max: 145
  },
  notes: "مشي صباحي في الحديقة",
  feelingAfter: "energized", // energized, tired, sore
  
  // بيانات التتبع (اختياري)
  trackData: {
    route: "...", // GeoJSON أو بيانات GPS
    elevationGain: 45 // بالمتر
  }
}
```

### 9. مجموعة النوم `sleep`

تخزن بيانات نوم المستخدم.

```javascript
// وثيقة النوم - معرّف تلقائي
{
  userId: "userId",
  date: "2025-09-12", // تاريخ بداية النوم
  startTime: "23:30",
  endTime: "07:15",
  duration: 465, // بالدقائق
  quality: 4, // 1-5
  deepSleepDuration: 125, // بالدقائق
  remSleepDuration: 90, // بالدقائق
  lightSleepDuration: 250, // بالدقائق
  wakeTime: 15, // وقت الاستيقاظ بالدقائق
  interruptions: 2, // عدد مرات الاستيقاظ
  factors: ["caffeine", "stress"], // عوامل قد تؤثر على النوم
  notes: "نوم متقطع بسبب الضجيج الخارجي",
  
  // معلومات الجهاز (إذا كان مرتبطاً بجهاز تتبع)
  deviceType: "fitbit",
  deviceId: "FB12345"
}
```

### 10. مجموعة الصحة النفسية `mentalHealth`

تخزن بيانات الحالة النفسية وتقييمات الصحة النفسية.

```javascript
// وثيقة تقييم الصحة النفسية - معرّف تلقائي
{
  userId: "userId",
  date: "2025-09-13",
  timestamp: Timestamp,
  assessmentType: "mood", // mood, anxiety, depression, stress
  
  // نتائج التقييم
  scores: {
    overall: 78,
    subScores: {
      anxiety: 12,
      depression: 8,
      stress: 15
    }
  },
  
  // مقياس المزاج (1-10)
  mood: {
    level: 7,
    description: "مستقر",
    factors: ["عمل ناجح", "راحة كافية"]
  },
  
  // أنشطة الرعاية الذاتية
  selfCareActivities: ["تأمل", "قراءة", "مشي"],
  
  notes: "يوم جيد بشكل عام مع بعض ضغوط العمل",
  
  // تتبع الأعراض (اختياري)
  symptoms: {
    insomnia: 2, // 0-5
    anxiety: 1, // 0-5
    fatigue: 2 // 0-5
  },
  
  // توصيات
  recommendedActions: ["تمارين تنفس", "الحد من وقت الشاشة"]
}
```

### 11. مجموعة الوصفات الصحية `recipes`

تخزن الوصفات الصحية مع معلوماتها الغذائية.

```javascript
// وثيقة الوصفة - معرّف تلقائي
{
  title: "سلطة كينوا بالخضروات",
  category: "salad", // main, salad, soup, dessert, snack, etc.
  cuisine: "mediterranean",
  preparationTime: 15, // بالدقائق
  cookingTime: 20, // بالدقائق
  servings: 4,
  difficulty: "easy", // easy, medium, hard
  
  // مكونات الوصفة
  ingredients: [
    {
      name: "كينوا",
      amount: 1,
      unit: "كوب",
      nutritionPer100g: {
        calories: 120,
        protein: 4.4,
        carbs: 21.3,
        fat: 1.9
      }
    },
    {
      name: "طماطم",
      amount: 2,
      unit: "حبة متوسطة",
      nutritionPer100g: {
        calories: 18,
        protein: 0.9,
        carbs: 3.9,
        fat: 0.2
      }
    }
  ],
  
  // خطوات التحضير
  instructions: [
    "اغسلي الكينوا جيدًا تحت الماء البارد",
    "ضعي الكينوا في وعاء مع ضعف كميتها من الماء",
    "..."
  ],
  
  // القيم الغذائية للوجبة الكاملة
  nutritionPerServing: {
    calories: 320,
    protein: 12,
    carbs: 45,
    fat: 9,
    fiber: 7,
    sugar: 3
  },
  
  // معلومات إضافية
  tags: ["نباتي", "غني بالبروتين", "خالي من الغلوتين"],
  photoURL: "https://storage.example.com/recipes/quinoa-salad.jpg",
  videoURL: "https://example.com/videos/quinoa-salad",
  author: "د. كامل المنجليفي",
  isFeatured: true,
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

### 12. مجموعة الأعشاب الطبية `herbs`

تخزن معلومات الأعشاب الطبية وفوائدها.

```javascript
// وثيقة العشبة - معرّف تلقائي
{
  name: "الزنجبيل",
  scientificName: "Zingiber officinale",
  category: ["digestive", "anti-inflammatory"],
  
  // المعلومات الأساسية
  description: "جذر نباتي له خصائص مضادة للالتهاب ويساعد في علاج اضطرابات الجهاز الهضمي",
  origin: ["آسيا", "الهند", "الصين"],
  
  // الفوائد الصحية
  benefits: [
    {
      condition: "الغثيان",
      effectiveness: "high", // low, moderate, high
      evidenceStrength: "strong", // anecdotal, moderate, strong
      description: "يساعد في تقليل الغثيان خاصة المرتبط بالحمل أو العلاج الكيميائي"
    },
    {
      condition: "التهاب المفاصل",
      effectiveness: "moderate",
      evidenceStrength: "moderate",
      description: "يساعد في تخفيف آلام المفاصل والالتهابات"
    }
  ],
  
  // طرق الاستخدام
  usageMethods: [
    {
      method: "شاي",
      instructions: "نقع 1-2 سم من الجذر المبشور في ماء مغلي لمدة 5-10 دقائق",
      dosage: "1-3 أكواب يومياً"
    },
    {
      method: "مكمل غذائي",
      instructions: "تناول كبسولات الزنجبيل حسب التعليمات",
      dosage: "500-1000 مج يومياً"
    }
  ],
  
  // الاحتياطات والتحذيرات
  precautions: [
    "قد يتفاعل مع أدوية سيولة الدم",
    "يجب استشارة الطبيب للحوامل والمرضعات",
    "قد يسبب حرقة المعدة لبعض الأشخاص"
  ],
  
  // التفاعلات الدوائية
  interactions: [
    {
      drugCategory: "مضادات تخثر الدم",
      severity: "moderate", // mild, moderate, severe
      description: "قد يزيد من تأثير مضادات تخثر الدم"
    }
  ],
  
  photoURL: "https://storage.example.com/herbs/ginger.jpg",
  references: [
    "Journal of Medicinal Food, 2016; 19(8): 717-729",
    "Phytotherapy Research, 2015; 29(11): 1720-1725"
  ],
  
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

### 13. مجموعة الدراسات العلمية `studies`

تخزن ملخصات الدراسات العلمية المتعلقة بالصحة والتغذية.

```javascript
// وثيقة الدراسة - معرّف تلقائي
{
  title: "تأثير استهلاك الزنجبيل على مستويات الالتهاب",
  authors: ["محمد أحمد", "سارة خالد", "جون سميث"],
  publicationDate: "2024-03-15",
  journal: "المجلة الدولية للتغذية السريرية",
  
  // ملخص الدراسة
  abstract: "هدفت هذه الدراسة إلى تقييم تأثير استهلاك الزنجبيل على مؤشرات الالتهاب...",
  
  // التفاصيل
  studyType: "clinical", // clinical, observational, meta-analysis, review
  participants: 120,
  duration: "12 weeks",
  
  // النتائج الرئيسية
  findings: [
    {
      parameter: "CRP (بروتين سي التفاعلي)",
      change: "انخفاض بنسبة 23%",
      pValue: "p < 0.01",
      significance: "significant"
    },
    {
      parameter: "IL-6 (إنترلوكين 6)",
      change: "انخفاض بنسبة 18%",
      pValue: "p < 0.05",
      significance: "significant"
    }
  ],
  
  // الخلاصة والتوصيات
  conclusions: "أظهرت الدراسة أن استهلاك 1 جرام من الزنجبيل يومياً لمدة 12 أسبوع يؤدي إلى انخفاض كبير في مؤشرات الالتهاب.",
  clinicalImplications: "قد يكون للزنجبيل دور مساعد في علاج الحالات المرتبطة بالالتهاب المزمن.",
  
  // معلومات إضافية
  doi: "10.1234/jcn.2024.1234",
  url: "https://example.com/study/1234",
  keywords: ["الزنجبيل", "الالتهاب", "مضادات الأكسدة", "العلاج الغذائي"],
  
  // تصنيفات وتقييمات
  categories: ["مضادات الالتهاب", "الأعشاب الطبية", "التغذية العلاجية"],
  evidenceLevel: "B", // A, B, C, D
  
  // الإضافات
  attachments: [
    {
      type: "pdf",
      url: "https://storage.example.com/studies/study1234.pdf",
      description: "النص الكامل للدراسة"
    },
    {
      type: "image",
      url: "https://storage.example.com/studies/graph1234.jpg",
      description: "رسم بياني للنتائج الرئيسية"
    }
  ],
  
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

### 14. مجموعة المؤشرات الصحية `healthMetrics`

تخزن المؤشرات الصحية المجمعة للمستخدمين.

```javascript
// وثيقة المؤشرات الصحية - المعرّف: نفس uid المستخدم
{
  userId: "userId",
  lastUpdated: Timestamp,
  
  // المؤشر الصحي العام (0-100)
  healthScore: 85,
  
  // مؤشرات فرعية (0-100 لكل منها)
  subScores: {
    nutrition: 80,
    activity: 75,
    sleep: 85,
    mentalHealth: 90,
    vitalSigns: 88
  },
  
  // ملخص البيانات الصحية الحالية
  currentStats: {
    weight: 75,
    bmi: 23.7,
    bloodPressure: "120/80",
    glucose: 95,
    restingHeartRate: 68,
    sleepAverage: 7.5
  },
  
  // اتجاهات (مقارنة بآخر قياس)
  trends: {
    weight: "stable", // decreasing, stable, increasing
    bloodPressure: "improving",
    glucose: "stable",
    activity: "increasing"
  },
  
  // توصيات تلقائية
  recommendations: [
    {
      category: "nutrition",
      suggestion: "زيادة تناول البروتين",
      reason: "مستوى البروتين في النظام الغذائي أقل من الموصى به",
      priority: "medium" // low, medium, high
    },
    {
      category: "activity",
      suggestion: "زيادة تمارين القلب",
      reason: "معدل ضربات القلب أثناء الراحة أعلى من المعدل المثالي",
      priority: "high"
    }
  ],
  
  // مواعيد الفحص الدورية
  screeningDue: [
    {
      name: "فحص الكوليسترول",
      dueDate: "2025-12-15",
      priority: "medium"
    }
  ]
}
```

## الفهارس (Indexes)

لتحسين أداء الاستعلامات الشائعة، يجب إنشاء الفهارس المركبة التالية:

### الفهارس المطلوبة

1. مجموعة `measurements`:
   - `userId` (صاعد) + `type` (صاعد) + `date` (نازل)
   - `userId` (صاعد) + `timestamp` (نازل)
   - `userId` (صاعد) + `type` (صاعد) + `timestamp` (نازل)

2. مجموعة `medicalTests`:
   - `userId` (صاعد) + `date` (نازل)

3. مجموعة `medications`:
   - `userId` (صاعد) + `active` (صاعد)
   - `userId` (صاعد) + `refillDate` (صاعد)

4. مجموعة `reminders`:
   - `userId` (صاعد) + `date` (صاعد) + `time` (صاعد)
   - `userId` (صاعد) + `isDone` (صاعد) + `date` (صاعد)
   - `userId` (صاعد) + `type` (صاعد) + `date` (صاعد)

5. مجموعة `nutrition`:
   - `userId` (صاعد) + `date` (نازل)
   - `userId` (صاعد) + `mealType` (صاعد) + `date` (نازل)

6. مجموعة `activities`:
   - `userId` (صاعد) + `date` (نازل)
   - `userId` (صاعد) + `activityType` (صاعد) + `date` (نازل)

7. مجموعة `sleep`:
   - `userId` (صاعد) + `date` (نازل)
   - `userId` (صاعد) + `quality` (نازل) + `date` (نازل)

8. مجموعة `mentalHealth`:
   - `userId` (صاعد) + `date` (نازل)
   - `userId` (صاعد) + `assessmentType` (صاعد) + `date` (نازل)

## العلاقات بين المجموعات

![علاقات بين المجموعات](https://i.ibb.co/M6NzHcL/healthy-app-db-schema.png)

*ملاحظة: الرابط أعلاه هو مثال توضيحي، ويمكن استبداله برابط صورة حقيقية.*

### الترابط بين المجموعات

- **محور المستخدم**: `users` هي المجموعة المركزية التي ترتبط بها جميع المجموعات الأخرى عبر `userId`.
- **علاقة 1:1**: المستخدم وملفه الطبي (`users` و `medicalProfiles`)
- **علاقة 1:1**: المستخدم ومؤشراته الصحية (`users` و `healthMetrics`)
- **علاقة 1:N**: المستخدم وقياساته/أدويته/تذكيراته/إلخ (باقي المجموعات)
- **العلاقات المرجعية**:
  - `reminders.relatedItemId` يمكن أن يشير إلى وثيقة في `medications` أو غيرها
  - `nutrition.items` يمكن أن تحتوي على مراجع لوثائق في قاموس الأغذية

## قواعد الأمان

### قواعد الوصول العامة

1. **القراءة**: المستخدم يمكنه فقط قراءة البيانات الخاصة به (حيث `userId` == `request.auth.uid`)
2. **الكتابة**: المستخدم يمكنه فقط كتابة/تعديل البيانات الخاصة به
3. **المشاركة**: يمكن مشاركة بعض البيانات مع أخصائيين محددين (متى ما كان `userId` في قائمة `linkedNutritionists`)

### مثال على قواعد Firestore

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // قواعد للمستخدمين
    match /users/{userId} {
      allow read: if request.auth != null && request.auth.uid == userId;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // قواعد للملفات الطبية
    match /medicalProfiles/{profileId} {
      allow read: if request.auth != null && (
        request.auth.uid == profileId || 
        get(/databases/$(database)/documents/users/$(profileId)).data.linkedNutritionists.hasAny([request.auth.uid])
      );
      allow write: if request.auth != null && request.auth.uid == profileId;
    }
    
    // قاعدة عامة لباقي المجموعات
    match /{collection}/{docId} {
      allow read: if request.auth != null && (
        resource.data.userId == request.auth.uid || 
        get(/databases/$(database)/documents/users/$(resource.data.userId)).data.linkedNutritionists.hasAny([request.auth.uid])
      );
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
      allow update, delete: if request.auth != null && resource.data.userId == request.auth.uid;
    }
  }
}
```

## التخزين المؤقت والأداء

لتحسين أداء التطبيق وتقليل استخدام قاعدة البيانات، يمكن تنفيذ استراتيجيات التخزين المؤقت التالية:

1. **تخزين مؤقت محلي** للبيانات المستخدمة بشكل متكرر (معلومات المستخدم الأساسية، الإعدادات).
2. **تخزين مؤقت غير متصل** لتمكين استخدام التطبيق دون اتصال بالإنترنت.
3. **استراتيجية التحميل المسبق** للبيانات المرجح استخدامها (مثل تذكيرات اليوم، القياسات الأخيرة).
4. **تحديث جزئي للبيانات** بدلاً من إعادة تحميل المجموعات الكاملة.
5. **مستمعي الوقت الحقيقي** فقط للبيانات التي تتطلب تحديثات فورية.

## الترحيل من الهيكل الحالي

للانتقال من هيكل البيانات الحالي إلى الهيكل الجديد، نقترح استراتيجية الترحيل التدريجي:

1. **تصدير البيانات الحالية** من Firestore إلى مستندات JSON.
2. **تحويل البيانات** باستخدام برنامج نصي إلى الهيكل الجديد.
3. **استيراد البيانات المحولة** إلى قاعدة بيانات Firestore جديدة.
4. **تحديث التطبيق** لاستخدام الهيكل الجديد مع الحفاظ على التوافق مع الهيكل القديم خلال فترة انتقالية.
5. **الاختبار الشامل** للتأكد من عدم فقدان البيانات وصحة العمليات.

## ملاحظات ختامية

هذا التصميم يهدف إلى تحقيق توازن بين سهولة الاستخدام، الأداء، والمرونة. يمكن تعديل هيكل البيانات حسب الاحتياجات الخاصة والمتطلبات المستقبلية للتطبيق. من المهم مراقبة استخدام قاعدة البيانات وأدائها بشكل مستمر وتحسين الهيكل حسب الحاجة.

---

*ملاحظة: هذا التصميم قابل للتعديل والتطوير بناءً على المتطلبات المحددة والتغذية الراجعة من فريق التطوير.*